<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link rel="shortcut icon" href="./resources/img/Snake.png" type="image/x-icon"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Snake JS</title><style>@-webkit-keyframes background_rotation{0%,to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}50%{-webkit-transform:rotate(1080deg);transform:rotate(1080deg)}}@keyframes background_rotation{0%,to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}50%{-webkit-transform:rotate(1080deg);transform:rotate(1080deg)}}@-webkit-keyframes foreground_rotation{0%,to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}20%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}40%{-webkit-transform:rotate(45deg);transform:rotate(45deg)}60%{-webkit-transform:rotate(-180deg);transform:rotate(-180deg)}80%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}@keyframes foreground_rotation{0%,to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}20%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}40%{-webkit-transform:rotate(45deg);transform:rotate(45deg)}60%{-webkit-transform:rotate(-180deg);transform:rotate(-180deg)}80%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}@font-face{font-family:"Roboto";src:url(./resources/fonts/Roboto-Regular.ttf);font-weight:400;font-style:normal}.sound{visibility:hidden;width:100%;max-width:60px;height:42px;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer}.sound::after,.sound::before{display:block;visibility:visible;position:absolute}.sound::after{content:"OFF";width:30px;height:30px;background:#fff;border-radius:50%;left:1px;top:calc(51% - 15px + 1px);-webkit-transition:.5s;-o-transition:.5s;transition:.5s;text-align:center}.sound::before{content:"";width:100%;height:32px;max-height:42px;background:#7b6b6b;left:0;top:calc(50% - 16px);max-width:60px;border-radius:50px;border:1px solid #7b6b6b;-webkit-box-sizing:content-box;box-sizing:content-box}.sound.on::after{content:"ON";left:calc(100% - 30px + 1px)}.sound.on::before{background:#118c4e}.sound.disabled{cursor:default}.sound.disabled::after,.sound.disabled::before{background:#ecdddd}::-webkit-scrollbar{width:20px}::-webkit-scrollbar-track{background:0 0}::-webkit-scrollbar-thumb{background:#d6dee1;border-radius:20px;border:6px solid transparent;background-clip:content-box}::-webkit-scrollbar-thumb:hover{background-color:#a8bbbf}.tmbs{-webkit-appearance:none;margin:6% auto;width:90%;border-radius:19px}.tmbs::-webkit-slider-runnable-track{height:12px;cursor:pointer;border-radius:19px}.tmbs::-webkit-slider-thumb{-webkit-box-shadow:1px 1px 1px #000;box-shadow:1px 1px 1px #000;border:1px solid #000;height:35px;width:15px;border-radius:40%/20%;background:#dbdada;cursor:pointer;-webkit-appearance:none;margin-top:-14px}.tmbs.red::-webkit-slider-runnable-track{background:-webkit-gradient(linear,left top,right top,from(#000),to(red));background:linear-gradient(90deg,#000 ,red)}.tmbs.green::-webkit-slider-runnable-track{background:-webkit-gradient(linear,left top,right top,from(#000),to(#0f0));background:linear-gradient(90deg,#000 ,#0f0)}.tmbs.blue::-webkit-slider-runnable-track{background:-webkit-gradient(linear,left top,right top,from(#000),to(#00f));background:linear-gradient(90deg,#000 ,#00f)}.tmbs.white::-webkit-slider-runnable-track{background:-webkit-gradient(linear,left top,right top,from(#000),to(#fff));background:linear-gradient(90deg,#000 ,#fff)}#game_container,canvas{width:840px;height:660px}.death_container.active .img_container::before,.death_container.active img,.pause_container.active .img_container::before,.pause_container.active img{width:320px;height:320px}.death_container.active,.death_container.active p,.pause_container.active,.pause_container.active p,.prop span .plus{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}#by,#counter_container,#logo,#sound_container,.death_container.active,.death_container.active p,.pause_container.active,.pause_container.active p,.prop span .plus,.sound::after,header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}#by,#counter_container,#logo,.sound::after,header{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}header{padding-top:1%;padding-bottom:1%;height:5%;-webkit-box-pack:justify!important;-ms-flex-pack:justify!important;justify-content:space-between!important}body{font-family:"Roboto",sans-serif;padding:0;height:100%;background:#3d3434;color:#ead8d8}#logo{position:relative;left:3%;background:#7a7171;color:#f38282;font-size:26pt;height:60px;width:300px;border-radius:19px}#counter_container{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column;flex-flow:column}#counter_container #counter{margin-top:10px;font-size:25pt;margin-bottom:15px}#counter_container #prev_counter{height:28px;font-size:18pt;margin:0;font-family:Arial,"Helvetica Neue",Helvetica,sans-serif}#by{width:300px}#game_container{z-index:2;margin:auto}canvas{border:1px solid #000;margin:auto;background:green;background-size:cover!important}canvas:hover{cursor:none}.death_container,.pause_container{display:none}.death_container.active,.pause_container.active{position:absolute;color:#fff;width:841px;height:661px;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;background:#000;opacity:.7;cursor:pointer;font-size:25pt;font-family:Arial,"Helvetica Neue",Helvetica,sans-serif}.death_container.active .img_container img,.pause_container.active .img_container img{-webkit-animation:foreground_rotation 20s infinite ease-in-out;animation:foreground_rotation 20s infinite ease-in-out}.death_container.active .img_container::before,.pause_container.active .img_container::before{content:" ";z-index:-1;position:absolute;background:#fff;border-radius:33%;-webkit-animation:background_rotation 35s infinite ease-in-out;animation:background_rotation 35s infinite ease-in-out}.death_container.active p,.pause_container.active p,body{margin:0}#keys{text-align:center}#keys div{width:90%}.flex{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row wrap;flex-flow:row wrap;vertical-align:top;height:90%}.flex .flex_center{width:840px;-webkit-box-flex:2;-ms-flex:2;flex:2}.flex .flex_left,.flex .flex_right{width:15%;-webkit-box-flex:1;-ms-flex:1;flex:1;max-width:calc((100% - 840px)/2)}.flex .flex_right{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}#sound_container{font-size:22pt;width:90%;text-align:left;-webkit-box-pack:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly}#form_containers,.prop{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}#form_containers{margin-top:3%;height:70%;display:-webkit-box;display:-ms-flexbox;display:flex}#map_switcher_form{display:block!important;overflow:auto!important}.prop{width:80%;margin:0 auto;font-size:18pt;height:auto}.prop span,.prop span .plus{background:#7a7171;color:#ededed!important}.prop,.prop span{display:-webkit-box;display:-ms-flexbox;display:flex}.prop span{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;height:66px;padding:2% 4%;width:100%;border-radius:19px}.prop span .plus{width:35px;height:35px;background:#564343;border-radius:9px;cursor:pointer}.wrapper,.wrapper form{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:100%}.wrapper{display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important;background:#847e7e;-ms-flex-flow:wrap;flex-flow:wrap;height:0;padding:0;border-radius:19px;margin:3% auto;-webkit-transition:.8s;-o-transition:.8s;transition:.8s;overflow:hidden}.wrapper form{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%}.wrapper.active{padding:2% 4%;height:200px}#sound_switcher_form,#sound_switcher_form .sound_items,.prop span,.wrapper{-webkit-box-align:center;-ms-flex-align:center;align-items:center}#sound_switcher_form{display:block;overflow:auto}#sound_switcher_form .sound_items{display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}#footer{height:5%}</style></head><body><header><div id="logo"><p>Snake Game JS</p></div><div id="counter_container"><p id="counter">Счёт: 0</p><p id="prev_counter"></p></div><div id="by"><p>@by Euge</p></div></header><div class="flex"><div class="flex_left"><div id="form_containers"><div class="prop"><span>Выбрать цвет тела <mark class="plus">+</mark></span><div class="wrapper"><form name="bodyColorSwitcher"><div style="text-align: center">Тяните ползунки:</div><input type="range" min="0" max="255" name="bodyColorTumb" class="tmbs red" value="240"> <input type="range" min="0" max="255" name="bodyColorTumb" class="tmbs green" value="0"> <input type="range" min="0" max="255" name="bodyColorTumb" class="tmbs blue" value="0"></form></div></div><div class="prop"><span>Выбрать цвет головы <mark class="plus">+</mark></span><div class="wrapper"><form name="headColorSwitcher"><div style="text-align: center">Тяните ползунки:</div><input type="range" min="0" max="255" name="headColorTumb" class="tmbs red" value="255"> <input type="range" min="0" max="255" name="headColorTumb" class="tmbs green" value="255"> <input type="range" min="0" max="255" name="headColorTumb" class="tmbs blue" value="0"></form></div></div><div class="prop"><span>Настроить скорость <mark class="plus">+</mark></span><div class="wrapper"><form name="speedSwitcher"><div style="text-align: center">Тяните ползунок:</div><input type="range" min="100" max="300" name="speedTumb" class="tmbs white" value="200"></form></div></div><div class="prop"><span>Выбрать карту <mark class="plus">+</mark></span><div class="wrapper"><form id="map_switcher_form" name="mapSwitcher"><div><input type="radio" value="#008000" name="map" checked="checked"> <label for="map">Трава</label></div><div><input type="radio" value="HDgrass.jpg" name="map"> <label for="map">Трава HD</label></div><div><input type="radio" value="#f4a460" name="map"> <label for="map">Песок</label><div><input type="radio" value="HDsand.jpg" name="map"> <label for="map">Песок HD</label></div></div><div><input type="radio" value="#00bfff" name="map"> <label for="map">Вода</label></div><div><input type="radio" value="HDwater.jpg" name="map"> <label for="map">Вода HD</label></div><div><input type="radio" value="#cf1020" name="map"> <label for="map">Лава</label></div><div><input type="radio" value="HDlava.jpg" name="map"> <label for="map">Лава HD</label></div></form></div></div><div class="prop"><span>Настроить звук <mark class="plus">+</mark></span><div class="wrapper"><form name="soundSwitcher" id="sound_switcher_form"><div class="sound_items"><div>Все звуки &nbsp;</div><input id="sound_full" class="sound on" type="checkbox" name="sound" value="full" checked="checked"></div><div class="sound_items"><div>Нажатие клавиш &nbsp;</div><input id="event" class="sound on" type="checkbox" name="sound" value="Event.mp3" checked="checked"></div><div class="sound_items"><div>Рост змейки &nbsp;</div><input id="pickup" class="sound on" type="checkbox" name="sound" value="PickUp.mp3" checked="checked"></div><div class="sound_items"><div>Конец игры &nbsp;</div><input id="gameover" class="sound on" type="checkbox" name="sound" value="GameOver.mp3" checked="checked"></div></form></div></div></div></div><div class="flex_center"><div id="game_container"><div id="pause_container" class="pause_container"><div class="img_container"><img src="./resources/img/Pause.svg" alt="Pause"></div><br><p style="font-size: 17pt">Игра на паузе. Нажмите &#171;Пробел&#187;, чтобы продолжить.</p><br><p class="phrase" style="font-size: 13pt"></p></div><div id="death_container" class="death_container active"><div class="img_container"><img src="./resources/img/Play.svg" alt="Play"></div><br><p id="last_count" style="text-align: center; font-size: 17pt">Нажмите &#171;Ввод&#187;, чтобы начать.</p><br><p class="phrase" style="font-size: 13pt"></p></div><canvas id="canvas" width="840" height="660"></canvas><br><br><br></div></div><div id="keys" class="flex_right"><div style="font-size: 20pt; text-align: left"><p>Кушать круги!</p><mark><q>Пробел</q></mark> - пауза.<br><mark><q>Ввод</q></mark> - старт.<br><mark><q>w a s d</q> </mark>или <mark><q>&uarr; &larr; &darr; &rarr;</q></mark> - управление.<br><mark><q>H</q></mark> - вкл./выкл. звук<br><mark><q>J</q></mark> - вкл./выкл. звук кнопок<br><mark><q>K</q></mark> - вкл./выкл. звук роста<br><mark><q>L</q></mark> - вкл./выкл. звук проигрыша<br><mark><q>1/2/3/4/5</q></mark> - свернуть/развернуть форму<br><p style="font-size: 12pt"><mark style="background-color: red">Если</mark> при первом запуске карта не видна - выберите карту (проблема совместимости версий)</p></div></div></div><footer id="footer"></footer><script>class e{posX=0;posY=0;colors=[{color:"red"},{color:"orange"},{color:"blue"},{color:"purple"},{color:"pink"}];constructor(e){this.context=e.canvas.getContext("2d"),this.pixelSize=e.pixelSize,this.worldHeight=e.worldHeight,this.worldWidth=e.worldWidth}DrawApple(e){this.posX=s.getCoordinates(this.worldWidth,this.pixelSize),this.posY=s.getCoordinates(this.worldHeight,this.pixelSize),e&&-1!==e.findIndex((e=>e.posX===this.posX&&e.posY===this.posY))&&this.DrawApple(e),this.context.fillStyle=this.colors[s.getRandomInt(this.colors.length-1)].color,this.context.beginPath(),this.context.arc(this.posX+this.pixelSize/2,this.posY+this.pixelSize/2,this.pixelSize/2-2,0,2*Math.PI),this.context.fill(),this.context.stroke(),this.context.closePath()}Destroy(){this.context.clearRect(this.posX,this.posY,this.pixelSize,this.pixelSize)}CheckAppleCollision(e){for(let t=e.length-1;t>=0;t--)if(0===t){if(e[t].posX===this.posX&&e[t].posY===this.posY)return this.DrawApple(e),!0}else if(e[t].posX===this.posX&&e[t].posY===this.posY)return this.DrawApple(e),!1;return!1}}class t{step=30;dx=this.step;dy=0;frequency=300;timeStart=0;isGamePaused=!1;keys={left:["keya","arrowleft"],right:["keyd","arrowright"],up:["keyw","arrowup"],down:["keys","arrowdown"],space:"space",enter:"enter"};static world;constructor(e){this.keyEventSound=e.keyEventSound,this.InitGame(e)}InitGame(e){t.world=new r({...e,step:this.step,dx:this.dx,dy:this.dy,frequency:this.frequency}),e.pauseContainer.addEventListener("click",(()=>{this.isGamePaused=!this.isGamePaused,t.world.SetPlay()})),e.deathContainer.addEventListener("click",(()=>{this.dy=0,this.dx=this.step,t.world.snake.SetDirection(this.dx,this.dy),t.world.snake.isDead=!1,t.world.deathClassList.remove("active"),t.world.InitWorld()}))}SwitchDirection(e){if(!(new Date-this.timeStart<this.frequency-100)){if(-1!==this.keys.left.indexOf(e))this.dx=-this.step,this.dy=0;else if(-1!==this.keys.right.indexOf(e))this.dx=this.step,this.dy=0;else if(-1!==this.keys.up.indexOf(e))this.dx=0,this.dy=-this.step;else if(-1!==this.keys.down.indexOf(e))this.dx=0,this.dy=this.step;else if(this.keys.space===e){if(t.world.snake.isDead)return;this.isGamePaused=!this.isGamePaused,this.isGamePaused?t.world.SetPause():t.world.SetPlay()}else if(this.keys.enter===e){if(!t.world.snake.isDead)return;this.dy=0,this.dx=this.step,t.world.snake.SetDirection(this.dx,this.dy),t.world.snake.isDead=!1,t.world.deathClassList.remove("active"),t.world.InitWorld()}t.world.PlaySound(this.keyEventSound),t.world.snake.SetDirection(this.dx,this.dy),this.timeStart=new Date}}}class s{constructor(){}static getRandomInt=e=>Math.floor(Math.random()*e);static getCoordinates=(e,t)=>Math.floor(Math.random()*(e/t))*t;static CheckABS=(e,t)=>Math.abs(e)===Math.abs(t)}class i{snakeList=[{posX:60,posY:0},{posX:30,posY:0},{posX:0,posY:0}];snakeOnStart=JSON.stringify(this.snakeList);constructor(e){this.context=e.canvas.getContext("2d"),this.pixelSize=e.pixelSize,this.dx=e.dx,this.dy=e.dy,this.worldWidth=e.worldWidth,this.worldHeight=e.worldHeight,this.bodyColorTumbs=e.bodyColorTumbs,this.headColorTumbs=e.headColorTumbs,this.isDead=!0}DrawSnake(){this.snakeList.forEach(((e,t)=>{if(this.context.clearRect(e.posX,e.posY,this.pixelSize,this.pixelSize),0===t)this.context.fillStyle=this.snakeColor.head,this.prevX=e.posX,this.prevY=e.posY,e.posX+=this.dx,e.posY+=this.dy,e.posX>this.worldWidth-this.pixelSize&&(e.posX=0),e.posX<0&&(e.posX=this.worldWidth-this.pixelSize),e.posY>this.worldHeight-this.pixelSize&&(e.posY=0),e.posY<0&&(e.posY=this.worldHeight-this.pixelSize);else{this.context.fillStyle=this.snakeColor.body;let t=e.posX,s=e.posY;e.posX=this.prevX,e.posY=this.prevY,this.prevX=t,this.prevY=s}this.context.fillRect(e.posX,e.posY,this.pixelSize,this.pixelSize)})),-1!==this.snakeList.slice(1).findIndex((e=>e.posX===this.snakeList[0].posX&&e.posY===this.snakeList[0].posY))&&(this.isDead=!0)}SetDirection(e,t){(!s.CheckABS(this.dx,e)&&!s.CheckABS(this.dy,t)||this.isDead)&&(this.dx=e,this.dy=t)}IncreaseLength(){this.snakeList.push({posX:this.snakeList[this.snakeList.length-1].posX,posY:this.snakeList[this.snakeList.length-1].posY})}SetColor(e=null){this.snakeColor=e??{body:`rgb(${this.bodyColorTumbs[0].value},\n        ${this.bodyColorTumbs[1].value},\n        ${this.bodyColorTumbs[2].value})`,head:`rgb(${this.headColorTumbs[0].value},\n        ${this.headColorTumbs[1].value},\n        ${this.headColorTumbs[2].value})`}}Destroy(){this.snakeList.map((e=>this.context.clearRect(e.posX,e.posY,this.pixelSize,this.pixelSize))),this.snakeList.splice(0),this.snakeList.push(...JSON.parse(this.snakeOnStart))}}class o{static quotes=[{text:"Главное не то, что было будет, а то, что будет было"},{text:"Сначала потом, затем снова опять"},{text:"Глупо рассказывать людям о 狼迹等待着, всё равно не поймут"},{text:"Если тебя съели - у тебя есть два выхода"},{text:"Настоящий отец - мать сын троюродный дед"},{text:"В этой жизни ты либо волк, либо не волк"},{text:"Враги не предают, предают враги"},{text:"Я редко когда думаю, а ещё реже думаю"},{text:"Ауф"},{text:"Папей чаю"},{text:"Легко вставать, когда ты не ложился"},{text:"Иногда жизнь — это жизнь, а ты в ней иногда."},{text:"Если в дверь не постучаться, ее никогда не откроют."},{text:"Тебя зовут по имени, но я зову тебя пить пиво."},{text:"Если тебе тяжело идти, значит ты жирный."},{text:"Сделал дело — дело сделано."},{text:"У батареек есть один минус, и один плюс…"},{text:"Легкой бывает только легкая дорога. Тяжелая дорога всегда трудна."},{text:"Не нужно менять себя ради кого-то, нужно менять носки каждый день, а то они воняют."},{text:"Никогда не поздно, никогда не рано — поменять все поздно, если это рано."},{text:"Я не боюсь ударов в спину, гораздо страшнее, если это моя спина…."},{text:"За двумя зайцами погонишься — рыбку из пруда не выловишь, делу время, а отмеришь семь раз…"}];static quotesGenerator=()=>this.quotes[s.getRandomInt(this.quotes.length)].text}class r{score=0;constructor(t){this.worldHeight=t.canvas.height,this.worldWidth=t.canvas.width,this.pixelSize=Math.round(this.worldWidth/28),this.frequency=t.frequency,this.pauseClassList=t.pauseClassList,this.deathClassList=t.deathClassList,this.quotesContainer=t.quotesContainer,this.scoreContainer=t.scoreContainer,this.lastScore=t.lastScore,this.bestScore=t.bestScore,this.pickAppleSound=t.pickAppleSound,this.deathSound=t.deathSound,this.soundSwitcher=t.soundSwitcher,this.apple=new e({canvas:canvas,pixelSize:this.pixelSize,worldHeight:this.worldHeight,worldWidth:this.worldWidth}),this.snake=new i({canvas:canvas,worldHeight:this.worldHeight,worldWidth:this.worldWidth,pixelSize:this.pixelSize,bodyColorTumbs:t.bodyColorTumbs,headColorTumbs:t.headColorTumbs,step:t.step,dx:t.dx,dy:t.dy}),this.GenerateQuote()}SetInterval(e){this.interval=setInterval((()=>{this.snake.DrawSnake(),this.apple.CheckAppleCollision(this.snake.snakeList)&&(this.snake.IncreaseLength(),this.IncreaseScore(),this.PlaySound(this.pickAppleSound)),this.snake.isDead&&this.GameOver()}),e)}ReSetInterval(e){this.frequency=e,this.interval&&(clearInterval(this.interval),this.SetInterval(this.frequency))}InitWorld(){this.apple.DrawApple(),this.SetInterval(this.frequency)}SetPause(){clearInterval(this.interval),this.pauseClassList.add("active"),this.GenerateQuote()}SetPlay(){this.pauseClassList.remove("active"),this.SetInterval(this.frequency)}GenerateQuote(){this.quotesContainer.forEach((e=>e.innerHTML=o.quotesGenerator()+"<br /> &copy; Волк."))}IncreaseScore(){this.score++,this.scoreContainer.innerText=`Счёт: ${this.score}`}DecreaseScore(){let e=+localStorage.getItem("prev");this.score>e&&(localStorage.setItem("prev",this.score.toString()),e=this.score,this.bestScore.innerText=`Лучший счёт: ${e}`),this.lastScore.innerHTML=`Игра окончена! \n    Ваш счёт: ${this.score}.<br/> \n    Лучший счёт: ${e} <br/>\n    Нажмите &#171;Ввод&#187;, чтобы начать сначала.`,this.score=0,this.scoreContainer.innerText=`Счёт: ${this.score}`}PlaySound(e){if(!this.soundSwitcher[0].checked)return;const t=e.src.match(/[^\/]+$/)[0];[...this.soundSwitcher].filter((e=>e.value===t))[0].checked&&e.play()}GameOver(){clearInterval(this.interval),this.PlaySound(this.deathSound),this.DecreaseScore(),this.snake.Destroy(),this.apple.Destroy(),this.deathClassList.add("active")}}const a={canvas:document.getElementById("canvas"),bodyColorTumbs:document.forms.bodyColorSwitcher.bodyColorTumb,headColorTumbs:document.forms.headColorSwitcher.headColorTumb,speedTumb:document.forms.speedSwitcher.speedTumb,pauseContainer:document.getElementById("pause_container"),deathContainer:document.getElementById("death_container"),pauseClassList:document.getElementById("pause_container").classList,deathClassList:document.getElementById("death_container").classList,quotesContainer:document.querySelectorAll(".phrase"),scoreContainer:document.getElementById("counter"),lastScore:document.getElementById("last_count"),bestScore:document.getElementById("prev_counter"),soundSwitcher:document.forms.soundSwitcher.sound,keyEventSound:new Audio(`./resources/sounds/${soundSwitcher.event.value}`),pickAppleSound:new Audio(`./resources/sounds/${soundSwitcher.pickup.value}`),deathSound:new Audio(`./resources/sounds/${soundSwitcher.gameover.value}`),formsPluses:[...document.getElementsByClassName("plus")],wrappers:[...document.getElementsByClassName("wrapper")],mapChangeRadios:[...document.forms.mapSwitcher.map]},h=new t(a);new class{constructor(e,t,s,i){this.tumbsColors=JSON.parse(localStorage.getItem("TumbsColors")),this.headTumbsColors=JSON.parse(localStorage.getItem("headTumbsColors")),this.bgnd=canvas.style.background=localStorage.getItem("Map")??"#008000",this.snakeColor={},this.limit=+e.speedTumb.max+ +e.speedTumb.min,this.setPath=e=>`url("./resources/img/maps/${e}")`,this.soundSwitcher=e.soundSwitcher,this.soundFull=[...e.soundSwitcher].filter((e=>"sound_full"===e.id))[0],this.formsPluses=e.formsPluses,this.wrappers=e.wrappers,this.SwitchSnakeDirection=i,this.keys={keyh:"sound_full",keyj:"event",keyk:"pickup",keyl:"gameover"},this.initEventListeners(e,t,s)}initEventListeners(e,t,s){this.initONLoad(e,t,s,this.soundSwitcher),this.initColorChanger(e,t),this.initSpeedChanger(e,s),this.initMapChanger(e),this.initSoundSwitcher(e),this.initFormsWrapper(e),this.initKeyboardListener(e)}initONLoad({bodyColorTumbs:e,headColorTumbs:t,speedTumb:s,mapChangeRadios:i,bestScore:o},r,a,h){document.addEventListener("DOMContentLoaded",(()=>{o.innerText=`Лучший счёт: ${localStorage.getItem("prev")||0}`,e[0].value=this.tumbsColors?.red??240,e[1].value=this.tumbsColors?.green??0,e[2].value=this.tumbsColors?.blue??0,t[0].value=this.headTumbsColors?.red??255,t[1].value=this.headTumbsColors?.green??255,t[2].value=this.headTumbsColors?.blue??0,r(),s.value=localStorage.getItem("Speed")??"200",a(this.limit-+s.value),i.forEach((e=>e.checked=this.bgnd.includes(e.value)));const n=JSON.parse(localStorage.getItem("SoundSwitchers"));n&&h.forEach((e=>{e.checked=n[e.id],e.checked?e.classList.add("on"):e.classList.remove("on"),this.toggleCheckboxes(e)}))}))}initColorChanger({bodyColorTumbs:e,headColorTumbs:t},s){[...e,...t].forEach((i=>{i.addEventListener("input",(()=>{this.snakeColor.body=`rgb(${e[0].value},${e[1].value},${e[2].value})`,this.snakeColor.head=`rgb(${t[0].value},${t[1].value},${t[2].value})`,s(this.snakeColor)})),i.addEventListener("change",(()=>{const s={head:{red:t[0].value,green:t[1].value,blue:t[2].value},body:{red:e[0].value,green:e[1].value,blue:e[2].value}};localStorage.setItem("headTumbsColors",JSON.stringify(s.head)),localStorage.setItem("TumbsColors",JSON.stringify(s.body))}))}))}initSpeedChanger({speedTumb:e},t){e.addEventListener("change",(()=>{t(this.limit-+e.value),localStorage.setItem("Speed",e.value)}))}initMapChanger({mapChangeRadios:e,canvas:t}){e.forEach((e=>{e.addEventListener("change",(()=>{const s=e.value,i=t.style.background=s.includes("#")?s:this.setPath(s);localStorage.setItem("Map",i)}))}))}initSoundSwitcher({soundSwitcher:e}){e.forEach((e=>{e.addEventListener("change",(()=>this.checkboxToggler(e,!1)))}))}initFormsWrapper({formsPluses:e}){e.forEach((e=>{e.addEventListener("click",(e=>{this.toggleActive(e.target,!1)}))}))}initKeyboardListener(){document.addEventListener("keydown",(e=>{let t=e.code.toLowerCase();const s=t.match(/key[w,a,s,d]/)??t.match(/arrow(up|down|left|right)/)??t.match(/space|enter/),i=t.match(/key[h,j,k,l]/),o=t.match(/\$*[1-9]/);(s??i??o)&&this.keyPressDispatcher(s,i,o,e)}))}checkboxToggler(e,t=!1){let s=e;if(t&&(s=[...this.soundSwitcher].filter((t=>t.id===this.keys[e]))[0],s.checked=!s.checked),!this.soundFull.checked&&"full"!==s.value)return;s.classList.toggle("on");let i={};this.soundSwitcher.forEach((e=>{i[e.id]=e.checked,this.toggleCheckboxes(e)})),localStorage.setItem("SoundSwitchers",JSON.stringify(i))}toggleCheckboxes(e){this.soundFull.checked||"full"===e.value||(e.classList.add("disabled"),e.disabled=!0),this.soundFull.checked&&"full"!==e.value&&(e.classList.remove("disabled"),e.disabled=!1)}toggleActive(e,t=!1){let s=e;if(t){let t=+e;if(!(t>=1&&t<=9&&t<=this.wrappers.length))return;s=this.formsPluses[--t]}const i=s.parentNode.nextElementSibling.classList;i.contains("active")?(i.remove("active"),s.innerText="+"):(this.wrappers.forEach((e=>e.classList.remove("active"))),this.formsPluses.forEach((e=>e.innerText="+")),i.toggle("active"),s.innerText="+"===s.innerText?"-":"+")}keyPressDispatcher(e,t,s,i){i.preventDefault(),e?this.SwitchSnakeDirection(e[0]):t?this.checkboxToggler(t[0],!0):s&&this.toggleActive(s[0],!0)}}(a,(()=>t.world.snake.SetColor()),(e=>t.world.ReSetInterval(e)),(e=>h.SwitchDirection(e)));</script></body></html>